function favoriteproposal(){
  var favorite_button = $('#favorite_button');
  var user_follow = $('#user_follow');
  user_follow.text("目前有 " + <%= @proposal.userproposalships.count+1 %> + " 人追蹤");
  favorite_button.text('已追蹤');
}
function nofavoriteproposal(){
  var favorite_button = $('#favorite_button');
  var user_follow = $('#user_follow');
  user_follow.text("目前有 " + <%= @proposal.userproposalships.count-1 %> + " 人追蹤");
  favorite_button.text('加入追蹤');
}

<% user_favor = current_user.userproposalships.find_by_proposal_id(@proposal.id) %>
<% if user_favor.nil? %>
  <% current_user.add_proposal_relationship(current_user, @proposal) %>
  favoriteproposal();
<% else %>
  <% user_favor.destroy %>
  nofavoriteproposal();
<% end %>

